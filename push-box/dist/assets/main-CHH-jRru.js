import{o as re,r as i,v as oe,a as be,S as ce,y as de,e as me,b as je,j as e,p as f,c as m,d as ye,C as he,f as p,s as V,n as ue,g as z,h as B,m as F,i as u,D as w,u as ve,k as te,l as Ce,q as xe,t as we,w as Ee,x as _e,z as Ie,A as ke,Q as Pe,B as Le,I as Se,E as Ae,F as Me,G as Ne,W as De}from"./globals-fkwlRXBi.js";const Re=["all","x","y","top","bottom","left","right"],Te=["border-box","padding-box"],_=["current","0"],Ge={...re,side:{type:"enum",className:"rt-r-side",values:Re,default:"all",responsive:!0},clip:{type:"enum",className:"rt-r-clip",values:Te,default:"border-box",responsive:!0},p:{type:"enum",className:"rt-r-p",values:_,parseValue:I,responsive:!0},px:{type:"enum",className:"rt-r-px",values:_,parseValue:I,responsive:!0},py:{type:"enum",className:"rt-r-py",values:_,parseValue:I,responsive:!0},pt:{type:"enum",className:"rt-r-pt",values:_,parseValue:I,responsive:!0},pr:{type:"enum",className:"rt-r-pr",values:_,parseValue:I,responsive:!0},pb:{type:"enum",className:"rt-r-pb",values:_,parseValue:I,responsive:!0},pl:{type:"enum",className:"rt-r-pl",values:_,parseValue:I,responsive:!0}};function I(s){return s==="current"?"inset":s}const ge=i.forwardRef((s,l)=>{const{asChild:o,className:d,...h}=oe(s,Ge,be);return i.createElement(o?ce:"div",{...h,ref:l,className:de("rt-Inset",d)})});ge.displayName="Inset";const $e={...re,...me,...je},fe=i.forwardRef((s,l)=>{const{asChild:o,className:d,...h}=oe(s,$e);return i.createElement(o?ce:"strong",{...h,ref:l,className:de("rt-Strong",d)})});fe.displayName="Strong";function Oe(){return e.jsxs(f,{position:"sticky",px:"4",py:"2",justify:"between",style:{borderBottom:"1px solid var(--gray-a2)"},children:[e.jsx(m,{children:e.jsx(ye,{children:"Let's push on Sui!"})}),e.jsx(m,{children:e.jsx(he,{})})]})}function pe(s,l){if(s==null)return{};var o={},d=Object.keys(s),h,b;for(b=0;b<d.length;b++)h=d[b],!(l.indexOf(h)>=0)&&(o[h]=s[h]);return o}var Ve=["color"],ze=i.forwardRef(function(s,l){var o=s.color,d=o===void 0?"currentColor":o,h=pe(s,Ve);return i.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},h,{ref:l}),i.createElement("path",{d:"M0.877075 7.49972C0.877075 3.84204 3.84222 0.876892 7.49991 0.876892C11.1576 0.876892 14.1227 3.84204 14.1227 7.49972C14.1227 11.1574 11.1576 14.1226 7.49991 14.1226C3.84222 14.1226 0.877075 11.1574 0.877075 7.49972ZM7.49991 1.82689C4.36689 1.82689 1.82708 4.36671 1.82708 7.49972C1.82708 10.6327 4.36689 13.1726 7.49991 13.1726C10.6329 13.1726 13.1727 10.6327 13.1727 7.49972C13.1727 4.36671 10.6329 1.82689 7.49991 1.82689ZM8.24993 10.5C8.24993 10.9142 7.91414 11.25 7.49993 11.25C7.08571 11.25 6.74993 10.9142 6.74993 10.5C6.74993 10.0858 7.08571 9.75 7.49993 9.75C7.91414 9.75 8.24993 10.0858 8.24993 10.5ZM6.05003 6.25C6.05003 5.57211 6.63511 4.925 7.50003 4.925C8.36496 4.925 8.95003 5.57211 8.95003 6.25C8.95003 6.74118 8.68002 6.99212 8.21447 7.27494C8.16251 7.30651 8.10258 7.34131 8.03847 7.37854L8.03841 7.37858C7.85521 7.48497 7.63788 7.61119 7.47449 7.73849C7.23214 7.92732 6.95003 8.23198 6.95003 8.7C6.95004 9.00376 7.19628 9.25 7.50004 9.25C7.8024 9.25 8.04778 9.00601 8.05002 8.70417L8.05056 8.7033C8.05924 8.6896 8.08493 8.65735 8.15058 8.6062C8.25207 8.52712 8.36508 8.46163 8.51567 8.37436L8.51571 8.37433C8.59422 8.32883 8.68296 8.27741 8.78559 8.21506C9.32004 7.89038 10.05 7.35382 10.05 6.25C10.05 4.92789 8.93511 3.825 7.50003 3.825C6.06496 3.825 4.95003 4.92789 4.95003 6.25C4.95003 6.55376 5.19628 6.8 5.50003 6.8C5.80379 6.8 6.05003 6.55376 6.05003 6.25Z",fill:d,fillRule:"evenodd",clipRule:"evenodd"}))}),Be=["color"],Fe=i.forwardRef(function(s,l){var o=s.color,d=o===void 0?"currentColor":o,h=pe(s,Be);return i.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},h,{ref:l}),i.createElement("path",{d:"M4.85355 2.14645C5.04882 2.34171 5.04882 2.65829 4.85355 2.85355L3.70711 4H9C11.4853 4 13.5 6.01472 13.5 8.5C13.5 10.9853 11.4853 13 9 13H5C4.72386 13 4.5 12.7761 4.5 12.5C4.5 12.2239 4.72386 12 5 12H9C10.933 12 12.5 10.433 12.5 8.5C12.5 6.567 10.933 5 9 5H3.70711L4.85355 6.14645C5.04882 6.34171 5.04882 6.65829 4.85355 6.85355C4.65829 7.04882 4.34171 7.04882 4.14645 6.85355L2.14645 4.85355C1.95118 4.65829 1.95118 4.34171 2.14645 4.14645L4.14645 2.14645C4.34171 1.95118 4.65829 1.95118 4.85355 2.14645Z",fill:d,fillRule:"evenodd",clipRule:"evenodd"}))});let J=35,Z=35,k;const C="https://croal99.github.io/push-box/push-box/images/",ae={block:`${C}block.gif`,wall:`${C}wall.png`,box:`${C}box.png`,ball:`${C}ball.png`,up:`${C}up.png`,down:`${C}down.png`,left:`${C}left.png`,right:`${C}right.png`};let x={block:void 0,wall:void 0,box:void 0,ball:void 0,up:void 0,down:void 0,left:void 0,right:void 0};const Ue=()=>{console.log("show help")},Q=s=>{let l=[];for(let o=0;o<s.length;o++)l[o]=s[o].concat();return l};function y(s,l){this.x=s,this.y=l}let r=new y(5,5),O,c,P=0,q=0,X=0,le,ne;function Ye({playManager:s,playMaps:l,handelPayForUpdateRecord:o,setBack:d}){const[h,b]=i.useState(!1),[L,U]=i.useState(!1),[S,ee]=i.useState(!1),[A,M]=i.useState("");function N(){console.log("init canvas"),le=document.getElementById("game-box"),ne=le.getContext("2d")}function v(){let n=x.block;for(let a=0;a<16;a++)for(let t=0;t<16;t++)ne.drawImage(n,J*t,Z*a,J,Z)}function E(n){for(let a=0;a<n.length;a++)for(let t=0;t<n[a].length;t++){let g=x.block;switch(n[a][t]){case 1:g=x.wall;break;case 2:g=x.ball;break;case 3:g=x.box;break;case 4:g=k,r.x=a,r.y=t;break;case 5:g=x.box;break}ne.drawImage(g,J*t-(g.width-J)/2,Z*a-(g.height-Z),g.width,g.height)}}const D=()=>{k=x.down,v(),E(c)},R=n=>{switch(n.keyCode){case 37:case 65:j("left");break;case 38:case 87:j("up");break;case 39:case 68:j("right");break;case 40:case 83:j("down");break}},j=n=>{let a,t;switch(n){case"up":k=x.up,a=new y(r.x-1,r.y),t=new y(r.x-2,r.y);break;case"down":k=x.down,a=new y(r.x+1,r.y),t=new y(r.x+2,r.y);break;case"left":k=x.left,a=new y(r.x,r.y-1),t=new y(r.x,r.y-2);break;case"right":k=x.right,a=new y(r.x,r.y+1),t=new y(r.x,r.y+2);break}Y(a,t)&&q++,v(),E(c),W()&&(P==1?(console.log("finish"),X<s.record.step?ee(!0):U(!0)):(console.log("pass!!!",P),b(!0)))},Y=(n,a)=>{if(n.x<0||n.y<0||n.x>c.length||n.y>c[0].length||c[n.x][n.y]==1)return!1;if(c[n.x][n.y]==3||c[n.x][n.y]==5){if(c[a.x][a.y]==1||c[a.x][a.y]==3)return!1;c[a.x][a.y]=3}c[n.x][n.y]=4;let t=O[r.x][r.y];return t!=2&&(t==5?t=2:t=0),c[r.x][r.y]=t,r=n,!0};function W(){for(let n=0;n<c.length;n++)for(let a=0;a<c[n].length;a++)if(O[n][a]==2&&c[n][a]!=3||O[n][a]==5&&c[n][a]!=3)return!1;return!0}const H=()=>{X=X+q,P++,O=Q(l[P].data),c=Q(l[P].data),k=x.down,q=0,b(!1),v(),E(c)},K=()=>{o(s.id.id,A,99998,X,T,G)},T=()=>{d()},G=n=>{console.log("trans error",n.message)};return i.useEffect(()=>{O=Q(l[P].data),c=Q(l[P].data),N();let n=0,a=0;for(let t in ae)a++;for(let t in ae)x[t]=new Image,x[t].onload=function(){++n>=a&&(console.log("load all images"),D())},x[t].src=ae[t];return window.addEventListener("keydown",R),()=>{console.log("game unmounted"),window.removeEventListener("keydown",R)}},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"game",children:[e.jsx("canvas",{id:"game-box",width:"560",height:"560"}),e.jsx("div",{id:"msg"}),e.jsxs(f,{gap:"3",children:[e.jsxs(p,{onClick:Ue,children:[e.jsx(ze,{})," Help"]}),e.jsxs(V,{children:[e.jsx(ue,{children:e.jsxs(p,{children:[e.jsx(Fe,{}),"Exit"]})}),e.jsxs(z,{maxWidth:"400px",children:[e.jsx(B,{children:"Confirm"}),e.jsx(F,{size:"2",mb:"4",children:"Exiting the game"}),e.jsx(f,{direction:"column",gap:"3",children:e.jsx("label",{children:e.jsx(u,{as:"div",size:"2",mb:"1",weight:"bold",children:"Exiting the game will not save your progress, and you will need to pay again to re-enter the game. Are you sure you want to exit?"})})}),e.jsxs(f,{gap:"3",mt:"4",justify:"end",children:[e.jsx(w,{children:e.jsx(p,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsx(w,{children:e.jsx(p,{onClick:d,children:"Exit"})})]})]})]})]})]}),e.jsx(V,{open:h,children:e.jsxs(z,{maxWidth:"400px",children:[e.jsx(B,{children:"Success"}),e.jsx(F,{size:"2",mb:"4"}),e.jsx(f,{direction:"column",gap:"3",children:e.jsx("label",{children:e.jsxs(u,{as:"div",size:"2",mb:"1",weight:"bold",children:["Congratulations, you used ",q," steps pass!"]})})}),e.jsx(f,{gap:"3",mt:"4",justify:"end",children:e.jsx(w,{children:e.jsx(p,{onClick:H,children:"Next"})})})]})}),e.jsx(V,{open:L,children:e.jsxs(z,{maxWidth:"400px",children:[e.jsx(B,{children:"Success"}),e.jsx(F,{size:"2",mb:"4"}),e.jsx(f,{direction:"column",gap:"3",children:e.jsx("label",{children:e.jsx(u,{as:"div",size:"2",mb:"1",weight:"bold",children:"Congratulations, you passed in 10 minutes!"})})}),e.jsx(f,{gap:"3",mt:"4",justify:"end",children:e.jsx(w,{children:e.jsx(p,{onClick:d,children:"Close"})})})]})}),e.jsx(V,{open:S,children:e.jsxs(z,{maxWidth:"400px",children:[e.jsx(B,{children:"Congratulations"}),e.jsx(F,{size:"2",mb:"4",children:"You've broken the record!"}),e.jsxs(f,{direction:"column",gap:"3",children:[e.jsxs("label",{children:[e.jsx(u,{as:"div",size:"2",mb:"1",children:"You can pay 0.001 Sui to register your name in the Game Plaza."}),e.jsx(u,{as:"div",size:"2",mb:"1",weight:"bold",children:"*The nickname cannot exceed 10 characters."})]}),e.jsx("label",{children:e.jsx(ve,{value:A,placeholder:"Enter nickname(No more than 10 characters)",onChange:n=>{M(n.target.value)}})})]}),e.jsxs(f,{gap:"3",mt:"4",justify:"end",children:[e.jsx(w,{children:e.jsx(p,{variant:"surface",onClick:d,children:"Close"})}),e.jsx(w,{children:e.jsx(p,{onClick:K,children:"Pay and Close"})})]})]})})]})}function We({manager:s,handlePlayGame:l}){return e.jsx(e.Fragment,{children:e.jsx(m,{maxWidth:"240px",children:e.jsxs(te,{size:"2",className:"game-icon",children:[e.jsx(ge,{clip:"padding-box",side:"top",pb:"current",children:e.jsx("img",{src:s.url,alt:s.name,style:{display:"block",objectFit:"cover",width:"100%",height:240,backgroundColor:"var(--gray-5)"}})}),e.jsxs(f,{direction:"column",gap:"2",children:[e.jsx(u,{as:"p",size:"3",align:"center",children:e.jsx(fe,{children:s.name})}),e.jsx(u,{as:"div",size:"2",mb:"1",weight:"bold",children:s.description}),e.jsxs(u,{as:"div",size:"2",mb:"1",weight:"bold",children:["Fee: ",s.fee/1e9," Sui"]}),e.jsxs(u,{as:"div",size:"2",mb:"1",children:["Best record: [",s.record.nickname,"]"]}),e.jsxs(u,{as:"div",size:"2",mb:"1",children:["Maps: [",s.maps_count,"]"]}),e.jsxs(V,{children:[e.jsx(ue,{children:e.jsx(p,{children:"Play"})}),e.jsxs(z,{maxWidth:"450px",children:[e.jsx(B,{children:s.name}),e.jsx(F,{size:"2",mb:"4",children:s.description}),e.jsxs(f,{direction:"column",gap:"3",children:[e.jsx("label",{children:e.jsxs(u,{as:"div",size:"2",mb:"1",weight:"bold",children:["Fee: ",s.fee/1e9," Sui"]})}),e.jsx("label",{children:e.jsxs(u,{as:"div",size:"2",mb:"1",children:["Best record: [",s.record.nickname,"]"]})}),e.jsx("label",{children:e.jsx(u,{as:"div",size:"2",mb:"1",children:s.record.time<1e6?e.jsxs(e.Fragment,{children:["time: ",s.record.time," second "]}):e.jsx(e.Fragment,{children:"time: wait for you"})})}),e.jsx("label",{children:e.jsx(u,{as:"div",size:"2",mb:"1",children:s.record.step<1e6?e.jsxs(e.Fragment,{children:["step: ",s.record.step," "]}):e.jsx(e.Fragment,{children:"step: wait for you"})})})]}),e.jsxs(f,{gap:"3",mt:"4",justify:"end",children:[e.jsx(w,{children:e.jsx(p,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsx(w,{children:e.jsx(p,{onClick:()=>l(s),children:"Pay and Play"})})]})]})]})]})]})})})}var He={VITE_MARKET_PACKAGE_ID:"0x3222202fddfc065b264a830298c54e8b70642ae30dcee71c0a7fb7021aea7149",VITE_PLAYGROUND_ID:"0xca74ea01e19b19d9329f96aacf7181c00bcf87148fd2f1af2b0b3928c5894927",VITE_MANAGER_TABLE_ID:"0x707b0cb887902197fae142482059238b7da30546d59796c21667bd0c8b5e618d",VITE_PLAYER_TABLE_ID:"0xd0196255259a9490962c2cf85a7e684a75a4076f4bcd988266b59d3a0eb8ba80",VITE_TEST_GAME_CONFIG_OBJECT_ID:"0x94618964cfaabb8639c6a720f563957d7101a658f01aa8376f6df2413531bd8d",BASE_URL:"/push-box/push-box/dist/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function Ke({getMapList:s,getPlayer:l,getPlayerList:o,getManagerList:d,getManageObject:h,getPushBoxObject:b,handleJoinGame:L,handelPayForUpdateRecord:U,handlePayAndPlayGame:S,setBack:ee}){const[A,M]=i.useState(null),[N,v]=i.useState([]),[E,D]=i.useState([]);i.useState([]),i.useState(!1);const[R,j]=i.useState(!1),W=He.VITE_PLAYGROUND_ID,H=a=>{S(a,K,T)},K=a=>{M(a),b(a.config_id).then(t=>{const g=[];t.maps.map((se,ie)=>{const{fields:$}=se;g.push($)}),v(g)})},T=a=>{console.log("trans error",a.message)},G=async()=>{console.log("close game"),await n()},n=async()=>{console.log("fetch data"),v([]),j(!0);try{const a=await d(W);D(a)}catch(a){console.log("error",a)}j(!1)};return i.useEffect(()=>(n().then(()=>{console.log("end fetch")}),()=>{console.log("UserMain uninstall")}),[]),R?e.jsx(m,{className:"back-image",children:e.jsx(m,{className:"login-container",children:e.jsx(te,{size:"3",children:e.jsxs(p,{children:[e.jsx(Ce,{loading:!0}),"Loading..."]})})})}):N.length>0?e.jsxs(m,{className:"back-image",children:[e.jsx(Oe,{}),e.jsx(Ye,{playMaps:N,playManager:A,handelPayForUpdateRecord:U,setBack:G})]}):e.jsx(e.Fragment,{children:e.jsx(m,{className:"back-image",pt:"4",px:"4",children:e.jsx(m,{pt:"4",px:"4",style:{background:"var(--gray-a2)",minHeight:800},children:e.jsx(xe,{columns:"5",gap:"4",children:E.map((a,t)=>e.jsx(We,{manager:a,handlePlayGame:H},t))})})})})}var Je={VITE_MARKET_PACKAGE_ID:"0x3222202fddfc065b264a830298c54e8b70642ae30dcee71c0a7fb7021aea7149",VITE_PLAYGROUND_ID:"0xca74ea01e19b19d9329f96aacf7181c00bcf87148fd2f1af2b0b3928c5894927",VITE_MANAGER_TABLE_ID:"0x707b0cb887902197fae142482059238b7da30546d59796c21667bd0c8b5e618d",VITE_PLAYER_TABLE_ID:"0xd0196255259a9490962c2cf85a7e684a75a4076f4bcd988266b59d3a0eb8ba80",VITE_TEST_GAME_CONFIG_OBJECT_ID:"0x94618964cfaabb8639c6a720f563957d7101a658f01aa8376f6df2413531bd8d",BASE_URL:"/push-box/push-box/dist/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function Ze(){const s=we();s==null||s.address;const[l,o]=i.useState(!1);i.useState(!1);const[d,h]=i.useState(!1),[b,L]=i.useState(!1);i.useState(!1),i.useState(!1);const S=Je.VITE_PLAYGROUND_ID;Ee();const{isLoading:ee,handleCreatePlayground:A,getPlaygroundObject:M,handleCreateManager:N,getManagerList:v,handleJoinGame:E,handlePayAndPlayGame:D}=_e(),{isLoading:R,getPlayer:j,getPlayerList:Y}=Ie(),{isLoading:W,mapList:H,message:K,getMapList:T,getPushBoxObject:G,getManageObject:n,handleCreateMaps:a,handleAddMap:t,handleSaveMapData:g,handelPayForUpdateRecord:se}=ke(),ie=async()=>{console.log("fetch data"),h(!0);try{const $=await M(S);o($)}catch($){console.log("error",$)}h(!1)};return i.useEffect(()=>(console.log("init application"),s?(ie().then(()=>{console.log("end fetch")}),()=>{console.log("uninstall application 2")}):(console.log("no account"),()=>{console.log("uninstall application 1")})),[s]),b?e.jsx(Ke,{getMapList:T,getPlayer:j,getPlayerList:Y,getManageObject:n,getPushBoxObject:G,getManagerList:v,handleJoinGame:E,setBack:L,handelPayForUpdateRecord:se,handlePayAndPlayGame:D}):e.jsx(e.Fragment,{children:e.jsx(m,{className:"back-image",children:e.jsx(m,{className:"login-container",children:e.jsx(te,{className:"login-form",style:{background:"var(--gray-a1)",maxWidth:400},children:e.jsxs(f,{direction:"column",gap:"3",children:[e.jsx(u,{as:"div",weight:"bold",size:"3",mb:"1",children:"Sokoban"}),e.jsx(u,{children:"Sokoban is a classic puzzle game renowned for its simple graphics, ingenious level design, and endless fun challenges. In this game, players control a small person navigating a grid-based map consisting of walls, empty spaces, and boxes. The objective is to push all the boxes to their designated target positions."}),s?e.jsx(xe,{columns:"1",gap:"2",children:e.jsx(p,{onClick:()=>{L(!0)},children:"Let's Play on Sui"})}):e.jsx(he,{})]})})})})})}var Qe={VITE_MARKET_PACKAGE_ID:"0x3222202fddfc065b264a830298c54e8b70642ae30dcee71c0a7fb7021aea7149",VITE_PLAYGROUND_ID:"0xca74ea01e19b19d9329f96aacf7181c00bcf87148fd2f1af2b0b3928c5894927",VITE_MANAGER_TABLE_ID:"0x707b0cb887902197fae142482059238b7da30546d59796c21667bd0c8b5e618d",VITE_PLAYER_TABLE_ID:"0xd0196255259a9490962c2cf85a7e684a75a4076f4bcd988266b59d3a0eb8ba80",VITE_TEST_GAME_CONFIG_OBJECT_ID:"0x94618964cfaabb8639c6a720f563957d7101a658f01aa8376f6df2413531bd8d",BASE_URL:"/push-box/push-box/dist/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const qe=new Pe;console.log(Qe);Le.createRoot(document.getElementById("root")).render(e.jsx(Se,{appearance:"dark",accentColor:"grass",children:e.jsx(Ae,{client:qe,children:e.jsx(Me,{networks:Ne,defaultNetwork:"testnet",children:e.jsx(De,{autoConnect:!0,children:e.jsx(Ze,{})})})})}));
