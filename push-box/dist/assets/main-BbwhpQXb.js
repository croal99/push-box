import{o as oe,r as i,v as ce,a as ye,S as de,y as he,e as ve,b as Ce,j as e,p as f,c as m,d as _e,C as ue,f as p,s as B,n as xe,g as z,h as F,m as U,i as u,D as C,u as Ee,k as ie,l as we,q as ge,t as Ie,w as ke,x as Pe,z as Se,A as Le,M as Ae,Q as Me,B as Ne,I as Te,E as De,F as Re,G as Ge,W as Oe}from"./globals-CtmiIwNY.js";const $e=["all","x","y","top","bottom","left","right"],Ve=["border-box","padding-box"],w=["current","0"],Be={...oe,side:{type:"enum",className:"rt-r-side",values:$e,default:"all",responsive:!0},clip:{type:"enum",className:"rt-r-clip",values:Ve,default:"border-box",responsive:!0},p:{type:"enum",className:"rt-r-p",values:w,parseValue:I,responsive:!0},px:{type:"enum",className:"rt-r-px",values:w,parseValue:I,responsive:!0},py:{type:"enum",className:"rt-r-py",values:w,parseValue:I,responsive:!0},pt:{type:"enum",className:"rt-r-pt",values:w,parseValue:I,responsive:!0},pr:{type:"enum",className:"rt-r-pr",values:w,parseValue:I,responsive:!0},pb:{type:"enum",className:"rt-r-pb",values:w,parseValue:I,responsive:!0},pl:{type:"enum",className:"rt-r-pl",values:w,parseValue:I,responsive:!0}};function I(a){return a==="current"?"inset":a}const fe=i.forwardRef((a,l)=>{const{asChild:o,className:d,...h}=ce(a,Be,ye);return i.createElement(o?de:"div",{...h,ref:l,className:he("rt-Inset",d)})});fe.displayName="Inset";const ze={...oe,...ve,...Ce},pe=i.forwardRef((a,l)=>{const{asChild:o,className:d,...h}=ce(a,ze);return i.createElement(o?de:"strong",{...h,ref:l,className:he("rt-Strong",d)})});pe.displayName="Strong";function Fe(){return e.jsxs(f,{position:"sticky",px:"4",py:"2",justify:"between",style:{borderBottom:"1px solid var(--gray-a2)"},children:[e.jsx(m,{children:e.jsx(_e,{children:"Let's push on Sui!"})}),e.jsx(m,{children:e.jsx(ue,{})})]})}function be(a,l){if(a==null)return{};var o={},d=Object.keys(a),h,b;for(b=0;b<d.length;b++)h=d[b],!(l.indexOf(h)>=0)&&(o[h]=a[h]);return o}var Ue=["color"],Ye=i.forwardRef(function(a,l){var o=a.color,d=o===void 0?"currentColor":o,h=be(a,Ue);return i.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},h,{ref:l}),i.createElement("path",{d:"M0.877075 7.49972C0.877075 3.84204 3.84222 0.876892 7.49991 0.876892C11.1576 0.876892 14.1227 3.84204 14.1227 7.49972C14.1227 11.1574 11.1576 14.1226 7.49991 14.1226C3.84222 14.1226 0.877075 11.1574 0.877075 7.49972ZM7.49991 1.82689C4.36689 1.82689 1.82708 4.36671 1.82708 7.49972C1.82708 10.6327 4.36689 13.1726 7.49991 13.1726C10.6329 13.1726 13.1727 10.6327 13.1727 7.49972C13.1727 4.36671 10.6329 1.82689 7.49991 1.82689ZM8.24993 10.5C8.24993 10.9142 7.91414 11.25 7.49993 11.25C7.08571 11.25 6.74993 10.9142 6.74993 10.5C6.74993 10.0858 7.08571 9.75 7.49993 9.75C7.91414 9.75 8.24993 10.0858 8.24993 10.5ZM6.05003 6.25C6.05003 5.57211 6.63511 4.925 7.50003 4.925C8.36496 4.925 8.95003 5.57211 8.95003 6.25C8.95003 6.74118 8.68002 6.99212 8.21447 7.27494C8.16251 7.30651 8.10258 7.34131 8.03847 7.37854L8.03841 7.37858C7.85521 7.48497 7.63788 7.61119 7.47449 7.73849C7.23214 7.92732 6.95003 8.23198 6.95003 8.7C6.95004 9.00376 7.19628 9.25 7.50004 9.25C7.8024 9.25 8.04778 9.00601 8.05002 8.70417L8.05056 8.7033C8.05924 8.6896 8.08493 8.65735 8.15058 8.6062C8.25207 8.52712 8.36508 8.46163 8.51567 8.37436L8.51571 8.37433C8.59422 8.32883 8.68296 8.27741 8.78559 8.21506C9.32004 7.89038 10.05 7.35382 10.05 6.25C10.05 4.92789 8.93511 3.825 7.50003 3.825C6.06496 3.825 4.95003 4.92789 4.95003 6.25C4.95003 6.55376 5.19628 6.8 5.50003 6.8C5.80379 6.8 6.05003 6.55376 6.05003 6.25Z",fill:d,fillRule:"evenodd",clipRule:"evenodd"}))}),We=["color"],He=i.forwardRef(function(a,l){var o=a.color,d=o===void 0?"currentColor":o,h=be(a,We);return i.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},h,{ref:l}),i.createElement("path",{d:"M4.85355 2.14645C5.04882 2.34171 5.04882 2.65829 4.85355 2.85355L3.70711 4H9C11.4853 4 13.5 6.01472 13.5 8.5C13.5 10.9853 11.4853 13 9 13H5C4.72386 13 4.5 12.7761 4.5 12.5C4.5 12.2239 4.72386 12 5 12H9C10.933 12 12.5 10.433 12.5 8.5C12.5 6.567 10.933 5 9 5H3.70711L4.85355 6.14645C5.04882 6.34171 5.04882 6.65829 4.85355 6.85355C4.65829 7.04882 4.34171 7.04882 4.14645 6.85355L2.14645 4.85355C1.95118 4.65829 1.95118 4.34171 2.14645 4.14645L4.14645 2.14645C4.34171 1.95118 4.65829 1.95118 4.85355 2.14645Z",fill:d,fillRule:"evenodd",clipRule:"evenodd"}))});let J=35,Z=35,k;const v="https://croal99.github.io/push-box/push-box/images/",ne={block:`${v}block.gif`,wall:`${v}wall.png`,box:`${v}box.png`,ball:`${v}ball.png`,up:`${v}up.png`,down:`${v}down.png`,left:`${v}left.png`,right:`${v}right.png`};let g={block:void 0,wall:void 0,box:void 0,ball:void 0,up:void 0,down:void 0,left:void 0,right:void 0};const Ke=()=>{console.log("show help")},Q=a=>{let l=[];for(let o=0;o<a.length;o++)l[o]=a[o].concat();return l};function y(a,l){this.x=a,this.y=l}let r=new y(5,5),V,c,L=0,q=0,X=0,re,te;function Je({playManager:a,playMaps:l,handelPayForUpdateRecord:o,setBack:d}){const[h,b]=i.useState(!1),[A,M]=i.useState(!1),[N,T]=i.useState(!1),[P,D]=i.useState("");function R(){console.log("init canvas"),re=document.getElementById("game-box"),te=re.getContext("2d")}function _(){let n=g.block;for(let s=0;s<16;s++)for(let t=0;t<16;t++)te.drawImage(n,J*t,Z*s,J,Z)}function E(n){for(let s=0;s<n.length;s++)for(let t=0;t<n[s].length;t++){let x=g.block;switch(n[s][t]){case 1:x=g.wall;break;case 2:x=g.ball;break;case 3:x=g.box;break;case 4:x=k,r.x=s,r.y=t;break;case 5:x=g.box;break}te.drawImage(x,J*t-(x.width-J)/2,Z*s-(x.height-Z),x.width,x.height)}}const Y=()=>{k=g.down,_(),E(c)},S=n=>{switch(n.keyCode){case 37:case 65:j("left");break;case 38:case 87:j("up");break;case 39:case 68:j("right");break;case 40:case 83:j("down");break}},j=n=>{let s,t;switch(n){case"up":k=g.up,s=new y(r.x-1,r.y),t=new y(r.x-2,r.y);break;case"down":k=g.down,s=new y(r.x+1,r.y),t=new y(r.x+2,r.y);break;case"left":k=g.left,s=new y(r.x,r.y-1),t=new y(r.x,r.y-2);break;case"right":k=g.right,s=new y(r.x,r.y+1),t=new y(r.x,r.y+2);break}W(s,t)&&q++,_(),E(c),H()&&(L==l.length-1?(console.log("finish"),X<a.record.step?T(!0):M(!0)):(console.log("pass!!!"),b(!0)))},W=(n,s)=>{if(n.x<0||n.y<0||n.x>c.length||n.y>c[0].length||c[n.x][n.y]==1)return!1;if(c[n.x][n.y]==3||c[n.x][n.y]==5){if(c[s.x][s.y]==1||c[s.x][s.y]==3)return!1;c[s.x][s.y]=3}c[n.x][n.y]=4;let t=V[r.x][r.y];return t!=2&&(t==5?t=2:t=0),c[r.x][r.y]=t,r=n,!0};function H(){for(let n=0;n<c.length;n++)for(let s=0;s<c[n].length;s++)if(V[n][s]==2&&c[n][s]!=3||V[n][s]==5&&c[n][s]!=3)return!1;return!0}const G=()=>{X=X+q,L++,V=Q(l[L].data),c=Q(l[L].data),k=g.down,q=0,b(!1),_(),E(c)},O=()=>{o(a.id.id,P,99998,X,K,$)},K=()=>{d()},$=n=>{console.log("trans error",n.message)};return i.useEffect(()=>{console.log("Play game",l,l.length),V=Q(l[L].data),c=Q(l[L].data),R();let n=0,s=0;for(let t in ne)s++;for(let t in ne)g[t]=new Image,g[t].onload=function(){++n>=s&&(console.log("load all images"),Y())},g[t].src=ne[t];return window.addEventListener("keydown",S),()=>{console.log("game unmounted"),window.removeEventListener("keydown",S)}},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"game",children:[e.jsx("canvas",{id:"game-box",width:"560",height:"560"}),e.jsx("div",{id:"msg"}),e.jsxs(f,{gap:"3",children:[e.jsxs(p,{onClick:Ke,children:[e.jsx(Ye,{})," Help"]}),e.jsxs(B,{children:[e.jsx(xe,{children:e.jsxs(p,{children:[e.jsx(He,{}),"Exit"]})}),e.jsxs(z,{maxWidth:"400px",children:[e.jsx(F,{children:"Confirm"}),e.jsx(U,{size:"2",mb:"4",children:"Exiting the game"}),e.jsx(f,{direction:"column",gap:"3",children:e.jsx("label",{children:e.jsx(u,{as:"div",size:"2",mb:"1",weight:"bold",children:"Exiting the game will not save your progress, and you will need to pay again to re-enter the game. Are you sure you want to exit?"})})}),e.jsxs(f,{gap:"3",mt:"4",justify:"end",children:[e.jsx(C,{children:e.jsx(p,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsx(C,{children:e.jsx(p,{onClick:d,children:"Exit"})})]})]})]})]})]}),e.jsx(B,{open:h,children:e.jsxs(z,{maxWidth:"400px",children:[e.jsx(F,{children:"Success"}),e.jsx(U,{size:"2",mb:"4"}),e.jsx(f,{direction:"column",gap:"3",children:e.jsx("label",{children:e.jsxs(u,{as:"div",size:"2",mb:"1",weight:"bold",children:["Congratulations, you used ",q," steps pass!"]})})}),e.jsx(f,{gap:"3",mt:"4",justify:"end",children:e.jsx(C,{children:e.jsx(p,{onClick:G,children:"Next"})})})]})}),e.jsx(B,{open:A,children:e.jsxs(z,{maxWidth:"400px",children:[e.jsx(F,{children:"Success"}),e.jsx(U,{size:"2",mb:"4"}),e.jsx(f,{direction:"column",gap:"3",children:e.jsx("label",{children:e.jsx(u,{as:"div",size:"2",mb:"1",weight:"bold",children:"Congratulations, you passed in 10 minutes!"})})}),e.jsx(f,{gap:"3",mt:"4",justify:"end",children:e.jsx(C,{children:e.jsx(p,{onClick:d,children:"Close"})})})]})}),e.jsx(B,{open:N,children:e.jsxs(z,{maxWidth:"400px",children:[e.jsx(F,{children:"Congratulations"}),e.jsx(U,{size:"2",mb:"4",children:"You've broken the record!"}),e.jsxs(f,{direction:"column",gap:"3",children:[e.jsxs("label",{children:[e.jsx(u,{as:"div",size:"2",mb:"1",children:"You can pay 0.001 Sui to register your name in the Game Plaza."}),e.jsx(u,{as:"div",size:"2",mb:"1",weight:"bold",children:"*The nickname cannot exceed 10 characters."})]}),e.jsx("label",{children:e.jsx(Ee,{value:P,placeholder:"Enter nickname(No more than 10 characters)",onChange:n=>{D(n.target.value)}})})]}),e.jsxs(f,{gap:"3",mt:"4",justify:"end",children:[e.jsx(C,{children:e.jsx(p,{variant:"surface",onClick:d,children:"Close"})}),e.jsx(C,{children:e.jsx(p,{onClick:O,children:"Pay and Close"})})]})]})})]})}function Ze({manager:a,handlePlayGame:l}){return e.jsx(e.Fragment,{children:e.jsx(m,{maxWidth:"240px",children:e.jsxs(ie,{size:"2",className:"game-icon",children:[e.jsx(fe,{clip:"padding-box",side:"top",pb:"current",children:e.jsx("img",{src:a.url,alt:a.name,style:{display:"block",objectFit:"cover",width:"100%",height:240,backgroundColor:"var(--gray-5)"}})}),e.jsxs(f,{direction:"column",gap:"2",children:[e.jsx(u,{as:"p",size:"3",align:"center",children:e.jsx(pe,{children:a.name})}),e.jsx(u,{as:"div",size:"2",mb:"1",weight:"bold",children:a.description}),e.jsxs(u,{as:"div",size:"2",mb:"1",weight:"bold",children:["Fee: ",a.fee/1e9," Sui"]}),e.jsxs(u,{as:"div",size:"2",mb:"1",children:["Best record: [",a.record.nickname,"]"]}),e.jsxs(u,{as:"div",size:"2",mb:"1",children:["Maps: [",a.maps_count,"]"]}),e.jsxs(B,{children:[e.jsx(xe,{children:e.jsx(p,{children:"Play"})}),e.jsxs(z,{maxWidth:"450px",children:[e.jsx(F,{children:a.name}),e.jsx(U,{size:"2",mb:"4",children:a.description}),e.jsxs(f,{direction:"column",gap:"3",children:[e.jsx("label",{children:e.jsxs(u,{as:"div",size:"2",mb:"1",weight:"bold",children:["Fee: ",a.fee/1e9," Sui"]})}),e.jsx("label",{children:e.jsxs(u,{as:"div",size:"2",mb:"1",children:["Best record: [",a.record.nickname,"]"]})}),e.jsx("label",{children:e.jsx(u,{as:"div",size:"2",mb:"1",children:a.record.time<1e6?e.jsxs(e.Fragment,{children:["time: ",a.record.time," second "]}):e.jsx(e.Fragment,{children:"time: wait for you"})})}),e.jsx("label",{children:e.jsx(u,{as:"div",size:"2",mb:"1",children:a.record.step<1e6?e.jsxs(e.Fragment,{children:["step: ",a.record.step," "]}):e.jsx(e.Fragment,{children:"step: wait for you"})})})]}),e.jsxs(f,{gap:"3",mt:"4",justify:"end",children:[e.jsx(C,{children:e.jsx(p,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsx(C,{children:e.jsx(p,{onClick:()=>l(a),children:"Pay and Play"})})]})]})]})]})]})})})}var Qe={VITE_MARKET_PACKAGE_ID:"0x3222202fddfc065b264a830298c54e8b70642ae30dcee71c0a7fb7021aea7149",VITE_PLAYGROUND_ID:"0xca74ea01e19b19d9329f96aacf7181c00bcf87148fd2f1af2b0b3928c5894927",VITE_MANAGER_TABLE_ID:"0x707b0cb887902197fae142482059238b7da30546d59796c21667bd0c8b5e618d",VITE_PLAYER_TABLE_ID:"0xd0196255259a9490962c2cf85a7e684a75a4076f4bcd988266b59d3a0eb8ba80",VITE_TEST_GAME_CONFIG_OBJECT_ID:"0x94618964cfaabb8639c6a720f563957d7101a658f01aa8376f6df2413531bd8d",BASE_URL:"/push-box/push-box/dist/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function qe({getMapList:a,getPlayer:l,getPlayerList:o,getManagerList:d,getManageObject:h,getPushBoxObject:b,handleJoinGame:A,handelPayForUpdateRecord:M,handlePayAndPlayGame:N,setBack:T}){const[P,D]=i.useState(null),[R,_]=i.useState([]),[E,Y]=i.useState([]);i.useState([]),i.useState(!1);const[S,j]=i.useState(!1),H=Qe.VITE_PLAYGROUND_ID,G=s=>{N(s,O,K)},O=s=>{D(s),b(s.config_id).then(t=>{const x=[];t.maps.map((ee,le)=>{const{fields:se}=ee;x.push(se)}),_(x)})},K=s=>{console.log("trans error",s.message)},$=async()=>{console.log("close game"),await n()},n=async()=>{console.log("fetch data"),_([]),j(!0);try{const s=await d(H);console.log("manager list",s),Y(s)}catch(s){console.log("error",s)}j(!1)};return i.useEffect(()=>(n().then(()=>{console.log("end fetch")}),()=>{console.log("UserMain uninstall")}),[]),S?e.jsx(m,{className:"back-image",children:e.jsx(m,{className:"login-container",children:e.jsx(ie,{size:"3",children:e.jsxs(p,{children:[e.jsx(we,{loading:!0}),"Loading..."]})})})}):R.length>0?e.jsxs(m,{className:"back-image",children:[e.jsx(Fe,{}),e.jsx(Je,{playMaps:R,playManager:P,handelPayForUpdateRecord:M,setBack:$})]}):e.jsx(e.Fragment,{children:e.jsx(m,{className:"back-image",pt:"4",px:"4",children:e.jsx(m,{pt:"4",px:"4",style:{background:"var(--gray-a2)",minHeight:800},children:e.jsx(ge,{columns:"5",gap:"4",children:E.map((s,t)=>e.jsx(Ze,{manager:s,handlePlayGame:G},t))})})})})}var Xe={VITE_MARKET_PACKAGE_ID:"0x3222202fddfc065b264a830298c54e8b70642ae30dcee71c0a7fb7021aea7149",VITE_PLAYGROUND_ID:"0xca74ea01e19b19d9329f96aacf7181c00bcf87148fd2f1af2b0b3928c5894927",VITE_MANAGER_TABLE_ID:"0x707b0cb887902197fae142482059238b7da30546d59796c21667bd0c8b5e618d",VITE_PLAYER_TABLE_ID:"0xd0196255259a9490962c2cf85a7e684a75a4076f4bcd988266b59d3a0eb8ba80",VITE_TEST_GAME_CONFIG_OBJECT_ID:"0x94618964cfaabb8639c6a720f563957d7101a658f01aa8376f6df2413531bd8d",BASE_URL:"/push-box/push-box/dist/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function es(){const a=Ie();a==null||a.address;const[l,o]=i.useState(!1);i.useState(!1);const[d,h]=i.useState(!1),[b,A]=i.useState(!1);i.useState(!1);const[M,N]=i.useState(!1),T=Xe,P=T.VITE_PLAYGROUND_ID,D=T.VITE_TEST_GAME_CONFIG_OBJECT_ID;ke();const{isLoading:R,handleCreatePlayground:_,getPlaygroundObject:E,handleCreateManager:Y,getManagerList:S,handleJoinGame:j,handlePayAndPlayGame:W}=Pe(),{isLoading:H,getPlayer:G,getPlayerList:O}=Se(),{isLoading:K,mapList:$,message:n,getMapList:s,getPushBoxObject:t,getManageObject:x,handleCreateMaps:ee,handleAddMap:le,handleSaveMapData:se,handelPayForUpdateRecord:me}=Le(),je=async()=>{console.log("fetch data"),h(!0);try{const ae=await E(P);o(ae)}catch(ae){console.log("error",ae)}h(!1)};return i.useEffect(()=>(console.log("init application"),a?(je().then(()=>{console.log("end fetch")}),()=>{console.log("uninstall application 2")}):(console.log("no account"),()=>{console.log("uninstall application 1")})),[a]),b?e.jsx(qe,{getMapList:s,getPlayer:G,getPlayerList:O,getManageObject:x,getPushBoxObject:t,getManagerList:S,handleJoinGame:j,setBack:A,handelPayForUpdateRecord:me,handlePayAndPlayGame:W}):M?e.jsx(Ae,{managerID:D,mapList:$,getMapList:s,handleCreateMaps:ee,handleAddMap:le,handleSaveMapData:se,setBack:N}):e.jsx(e.Fragment,{children:e.jsx(m,{className:"back-image",children:e.jsx(m,{className:"login-container",children:e.jsx(ie,{className:"login-form",style:{background:"var(--gray-a1)",maxWidth:400},children:e.jsxs(f,{direction:"column",gap:"3",children:[e.jsx(u,{as:"div",weight:"bold",size:"3",mb:"1",children:"Sokoban"}),e.jsx(u,{children:"Sokoban is a classic puzzle game renowned for its simple graphics, ingenious level design, and endless fun challenges. In this game, players control a small person navigating a grid-based map consisting of walls, empty spaces, and boxes. The objective is to push all the boxes to their designated target positions."}),a?e.jsx(ge,{columns:"1",gap:"2",children:e.jsx(p,{onClick:()=>{A(!0)},children:"Let's Play on Sui"})}):e.jsx(ue,{})]})})})})})}var ss={VITE_MARKET_PACKAGE_ID:"0x3222202fddfc065b264a830298c54e8b70642ae30dcee71c0a7fb7021aea7149",VITE_PLAYGROUND_ID:"0xca74ea01e19b19d9329f96aacf7181c00bcf87148fd2f1af2b0b3928c5894927",VITE_MANAGER_TABLE_ID:"0x707b0cb887902197fae142482059238b7da30546d59796c21667bd0c8b5e618d",VITE_PLAYER_TABLE_ID:"0xd0196255259a9490962c2cf85a7e684a75a4076f4bcd988266b59d3a0eb8ba80",VITE_TEST_GAME_CONFIG_OBJECT_ID:"0x94618964cfaabb8639c6a720f563957d7101a658f01aa8376f6df2413531bd8d",BASE_URL:"/push-box/push-box/dist/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const as=new Me;console.log(ss);Ne.createRoot(document.getElementById("root")).render(e.jsx(Te,{appearance:"dark",accentColor:"grass",children:e.jsx(De,{client:as,children:e.jsx(Re,{networks:Ge,defaultNetwork:"testnet",children:e.jsx(Oe,{autoConnect:!0,children:e.jsx(es,{})})})})}));
